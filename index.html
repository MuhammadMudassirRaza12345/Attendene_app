<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="view.html">
    <link rel="stylesheet" href="attendence.html">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- <script src="https://unpkg.com/axios/dist/axios.min.js"></script> -->
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
        <link rel="stylesheet" href="css/font-awesome.min.css">


</head>

<body>

    <div class="main">

        <!-- head1 -->
        <div class="header">
            <div class="container">
                <div class="row m-2 p-auto ">
                    <div class="  mx-auto  col-md-6 " style="text-align: center;">
                        <h1 class="t1 px-auto">Attendance app</h1>





                    </div>
                </div>

            </div>
        </div>

        <!-- head2 -->
        <div class="header2">
            <div class="container px-2 py-4">
                <!-- <div class="row m-2 p-auto ">
                    <div class="  mx-auto  col-md-6 " style="text-align: center;">
                        <div class="input-group mb-3">
                            <span class="input-group-text" id="basic-addon1">@</span>
                            <input type="text" class="form-control" placeholder="Username" aria-label="Username"
                                aria-describedby="basic-addon1">
                        </div>
                                       </div>
                </div> -->
                <form class="row g-3  p-4" onsubmit="addStudent(); return false;">
                    <div class="col-12">
                        <label for="inputEmail4" class="form-label">Full Name</label>
                        <input type="text" placeholder="Enter your full name" required class="form-control" id="input1">
                    </div>
                    <div class="col-12">
                        <label for="inputPassword4" class="form-label">Roll No </label>
                        <input type="text" placeholder="Enter your Roll No" required class="form-control" id="input2">
                    </div>
                    <div class="col-12">
                        <label for="inputState" class="form-label">BATCH NO</label>
                        <select id="input3" required class="form-select">
                            <option selected>Choose Batch No... </option>
                            <option>BATCH-17 </option>

                        </select>
                    </div>
                    <div class="col-12">
                        <label for="inputState" class="form-label">DEPARTMENT</label>
                        <select id="input4" required class="form-select">
                            <option selected>Choose Department ...</option>
                            <option>COMPUTER SCIENCE</option>

                        </select>
                    </div>

                    <!-- <div class="col-12">
                        <label for="inputAddress" class="form-label">Address</label>
                        <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St">
                    </div> -->
                    <!-- <div class="col-12">
                        <label for="inputAddress2" class="form-label">Address 2</label>
                        <input type="text" class="form-control" id="inputAddress2"
                            placeholder="Apartment, studio, or floor">
                    </div> -->
                    <!-- <div class="col-md-6">
                        <label for="inputCity" class="form-label">City</label>
                        <input type="text" class="form-control" id="inputCity">
                    </div> -->
                    <!-- <div class="col-md-4">
                        <label for="inputState" class="form-label">State</label>
                        <select id="inputState" class="form-select">
                            <option selected>Choose...</option>
                            <option>...</option>
                        </select>
                    </div> -->
                    <!-- <div class="col-md-2">
                        <label for="inputZip" class="form-label">Zip</label>
                        <input type="text" class="form-control" id="inputZip">
                    </div> -->
                    <!-- <div class="col-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gridCheck">
                            <label class="form-check-label" for="gridCheck">
                                Check me out
                            </label>
                        </div>
                    </div> -->
                    <div class="col-12 ">
                        <center> <button type="submit" class="btn btn-primary  mt-2 mx-2">ADD STUDENT</button>
                            <!-- <button type="submit" class="btn btn-primary  mt-2 mx-2"  onclick="getAllStudents()" >VIEW STUDENT <a href="./view.html"></a></button> -->
                            <button type="submit" class="btn btn-primary  mt-2 ml-2">GET ATTENDENCE </button>
                            <a class="btn btn-primary mt-2 mx-2"" href="./view.html">VIEW STUDENT</a>
                        </center>
                    </div>
                </form>





            </div>
        </div>



























        <h4 id="result"></h4>

        <br />
        <br />
        <br />
        <!-- <button  class="btn btn-primary  mt-2 mx-2"     onclick="getAllStudents()" > VIEW STUDENT </button> -->


        <!-- <button onclick="getAllStudents()" class="btn btn-dark">Get All Post</button> -->

        <!-- <br />
        <br /> -->
        <!-- <div class="header">
            <div class="container">
                <div class="row row-cols-1 row-cols-md-3 g-4 " id="posts">
                    


                </div>



            </div>

        </div> -->




        <!-- <button onclick="getAllStudents()">VIEW ALL STUDENT</button> -->




        <!-- 
        <div id="posts">

        </div> -->





        <hr>
        <hr>

        <form onsubmit="getAttendance(); return false;">

            Select date: <input required type="date" id="dateInput">
            <button type="submit">Get Attendance</button>

        </form>

        <br>
<!-- 
          <div id="att"></div>   -->

        <table  style="width: 100%;">
            <thead  >
                <tr  > 
                    <th>ID</th>
                    <th>NAME</th>
                    <th>ROLL NO</th>
                    <th>DEPARTMENT</th>
                    <th>BATCH NO</th>
                    <th>ATTENDENCE</th>
                </tr>
            

            </thead>
            <tbody id="att">




            </tbody>
        </table>
           





    </div>










    <script>
        const baseUrl = "http://localhost:3000";
        // const baseUrl = "https://yourappname.herokuapp.com";

        function addStudent() {
            let studentName = document.getElementById("input1").value;
            let studentRoll = document.getElementById("input2").value;
            // console.log(studentRoll)
            let studentBatchNo = document.getElementById("input3").value;
            let studentDepartment = document.getElementById("input4").value;

            var result = document.getElementById("result");

            axios.post(`${baseUrl}/student`, {
                studentName: studentName,
                studentRoll: studentRoll,

                studentBatchNo: studentBatchNo,
                studentDepartment: studentDepartment
            })
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);
                    result.innerText = responseData;

                    getAllStudents();
                })
                .catch(function (error) {
                    // handle error
                    console.log(error);
                })
        }

        function getAllStudents() {
            var posts = document.getElementById("posts");

            axios.get(`${baseUrl}/students`)
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);
                    

                    posts.innerHTML = "";

                    responseData.map(eachStudent => {
                        posts.innerHTML = `
                       <div class="col ">
                        <div class="card text-light bg-dark"  id="${eachStudent._id}">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-2 text-warning">${eachStudent._id}</h6>
                                <h5 class="card-title">student_Name :${eachStudent.studentName}</h5>
                                <p class="card-text">Roll NO : ${eachStudent.studentRoll} </p>
                                <p class="card-text">BATCH NO : ${eachStudent.studentBatchNo} </p>
                                <p class="card-text">DEPARTMENT: ${eachStudent.studentDepartment} </p>
                                s
                                <button href="#" class="btn btn-primary"  >EDIT</button>
                                <button href="#" class="btn btn-primary"  >DELETE</button>
                                <button href="#" class="btn btn-primary" onclick="markAttendance(''${eachStudent._id}', '${eachStudent.studentName}','${eachStudent.studentRoll}','${eachStudent.studentBatchNo}','${eachStudent.studentDepartment}')">Mark Present</button>
                            </div>
                        </div>


                       </div>
                       
                       `
                            // <hr />  
                            // <br />`
                            + posts.innerHTML;
                    })
                })
                .catch(function (error) {
                    // handle error
                    console.log(error);
                })
        }
        getAllStudents();

        function deletePost(id) {

            axios.delete(`${baseUrl}/post/${id}`)
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);
                    result.innerText = responseData;

                    getAllStudents();
                })
                .catch(function (error) {
                    // handle error
                    console.log(error);
                })
        }

        // function updatePost(id) {

        //     let newPost = prompt("please enter new text for that post");

        //     axios.put(`${baseUrl}/post/${id}`, { text: newPost })
        //         .then(function (response) {
        //             let responseData = response.data
        //             console.log("responseData: ", responseData);
        //             result.innerText = responseData;

        //             getAllStudents();
        //         })
        //         .catch(function (error) {
        //             // handle error
        //             console.log(error);
        //         })
        // }
        function updatePost(id) {

            document.getElementById(id).innerHTML = `
                <input type="text" id="${id}_text" placeholder="enter new text for this post" />
                <button onclick="doChanges('${id}')">do changes</button>
            `;
        }
        function doChanges(id) {

            let newText = document.getElementById(`${id}_text`).value;

            axios.put(`${baseUrl}/post/${id}`, { text: newText })
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);
                    result.innerText = responseData;

                    getAllStudents();
                })
                .catch(function (error) {
                    // handle error
                    console.log(error);
                })
        }

        function markAttendance(id, name,Roll,Batch,Department) {

            axios.post(`${baseUrl}/attendance`, {
                studentId: id,
                studentName: name,
                studentRoll:Roll,
                studentName:Batch,
                studentDepartment:Department,
                isPresent: true
            })
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);
                    alert(responseData)
                    // result.innerText = responseData;
                })
                .catch(function (error) {
                    // handle error
                    console.log(error);
                })
        }

        function getAttendance() {
            var date = document.getElementById("dateInput").value;
            var att = document.getElementById("att");


            console.log("date: ", date);

            axios.get(`${baseUrl}/attendance/${date}`)
                .then(function (response) {
                    let responseData = response.data
                    console.log("responseData: ", responseData);

                    var row

                    responseData.map(eachAtt => {
                        row =`        
                       <tr id="${eachAtt._id}> 
                            <td>${eachAtt._id}</td>
                             <td> ${eachAtt.studentName}</td>
                             <td> ${eachAtt.studentRoll}</td>
                              <td> ${eachAtt.studentBatchNo}</td>
                              <td> ${eachAtt.studentDepartment}</td>
                              <td> ${eachAtt.isPresent}</td>
                               </tr>
                            `
                            console.log(row)
                               $('#att').append(row);

                                                  
                            
                         
                        // + att.innerHTML;
                    })
                })
                .catch(function (error) {
                    //handle error
                    console.log(error);
                })
        }
        getAttendance();



    </script>


















</body>

</html>